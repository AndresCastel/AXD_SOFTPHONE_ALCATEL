using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Axede.DataObjects.Interface;
using System.Data;
using System.Data.Common;
using System.Xml;
using Axede.Utilidades.Enums;
using Axede.Global;
using Axede.Exception;
using Axede.Utilidades;
using Axede.Mensajes;
using Axede.DataObjects.Entities;
using System.Xml.Serialization;
using System.Reflection;
using System.Transactions;
using Axede.BussinesObject.Application;


namespace Axede.DataObjects.Dao.MySQL
{
    public partial class MySQL_CommonDao : BaseDatos, ICommonDao
    {
        #region Definiciones          

        #endregion

        #region Consultas_Ix_V8
        public List<DtoContactos> ObtenerContactos(int iIdeUser, string sInitialLetter)
        {
            List<DtoContactos> lstDtoContacto = new List<DtoContactos>();
            DtoContactos oDtoContacto = null;

            try
            {
                DbCommand dbcommand = _database.GetStoredProcCommand(PROCEDIMIENTOS.GetUsersIx);
                _database.AddInParameter(dbcommand, "iIdeUser", DbType.Int32, iIdeUser);
                _database.AddInParameter(dbcommand, "sInitialLetter", DbType.String, sInitialLetter);
                _database.AddInParameter(dbcommand, "iPage", DbType.Int32, "1");
                _database.AddInParameter(dbcommand, "iPageSize", DbType.Int32, "10");
                _database.ExecuteNonQuery(dbcommand);

                using (IDataReader dataReader = _database.ExecuteReader(dbcommand))
                {
                    while (dataReader.Read())
                    {
                        oDtoContacto = new DtoContactos();

                        oDtoContacto.Ide_Contact = Convert.ToInt32(dataReader["Ide_Contact"]);
                        oDtoContacto.Ide_User = Convert.ToInt32(dataReader["Ide_User"]);
                        oDtoContacto.Nombre = dataReader["Nom_Name"].ToString().ToUpper();
                        oDtoContacto.Apellido = dataReader["Nom_LastName"].ToString().ToUpper();
                        oDtoContacto.NombreCompleto = oDtoContacto.Nombre + " " + oDtoContacto.Apellido;
                        oDtoContacto.Telefono = dataReader["Vlr_PhoneNumber"].ToString();
                        oDtoContacto.Ide_PhoneType = Convert.ToInt32(dataReader["Ide_PhoneType"]);
                        oDtoContacto.Extension = dataReader["Num_Extension"].ToString();
                        oDtoContacto.Vlr_UserState = Convert.ToInt32(dataReader["Vlr_UserState"]);
                        oDtoContacto.Ide_RecentContact = Convert.ToInt32(dataReader["Ide_User"]);
                        if (oDtoContacto.Ide_RecentContact != null)
                        {
                            oDtoContacto.RecentContact = true;
                        }
                        else
                        {
                            oDtoContacto.RecentContact = false;
                        }

                        lstDtoContacto.Add(oDtoContacto);
                    }
                }
            }
            catch (System.Exception ex)
            {

                throw new DataBaseMySqlException(Globales.NombreAplicacion, ex.Message, ex);
            }


            return lstDtoContacto;
        }
        #endregion


        #region Privados

      #endregion
    }
}
